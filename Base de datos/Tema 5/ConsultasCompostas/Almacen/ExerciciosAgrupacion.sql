/****************************************************/
/******* FUNCIONES AGREGADO Y AGRUPACION ************/
/****************************************************/
use a23marcoscc_BD_Almacen_25;

-- 1. Visualizar todos los Oficios y el número de EMPLEADOS de la empresa que los desempeñan

 

-- 2. Visualizar todos los Oficios y el número de EMPLEADOS de la empresa que lo desempeñan,
-- siempre que sean más de uno
 

-- 3. Hallar el gasto salarial (salario + comision) anual de la empresa, suponiendo 14 pagas
 
 

-- 4. Obtener el número de EMPLEADOS que hay por cada Oficio en cada departamento de la empresa
 

-- 5. Calcular el número de Oficios distintos que hay en el departamento 30 de la tabla de EMPLEADOS
 

-- 6. Obtener los salarios medios por departamento
 
 
-- 7. Obtener para cada departamento, cuantos DIRECTORES hay.
 

-- 8. Obtener, para cada departamento, cuantos DIRECTORES hay en ese departamento y cual es su salario medio.
 
 
-- 9. Obtener el total de euros que hay invertidos entre todos los productos disponibles
 

--10. Visualizar las unidades totales vendidas de cada producto a cada cliente, 
--mostrando el número de producto, el número de cliente y la suma de las unidades
 

--11. Obtener las fechas de pedido de los productos, del pedido más antiguo y el más reciente de cada producto, 
--mostrando también el número de producto correspondiente
 

--12. Obtener los números de cliente de los dos clientes con mayor número de pedidos, 
--indicando también cuantos pedidos han hecho.
 

--13. Obtener las localidades en las que haya más de un cliente, visulizando cuantos clientes hay.
 


--14. Listar los n?meros de cliente que tengan más de dos pedidos, ordenado por cantidad de pedidos
 

--15. Obtener los datos de los 4 productos de los que más unidades se han vendido, 
--visualizando el número de producto y las unidades vendidas
 

--16. Obtener el total de unidades por producto que hay entre todos los pedidos, 
-- visualizando el número de producto, la descripción y la suma de todas las unidades.
 

--17. Obtener los salarios medios por departamento, ordenados descendentemente por dicho importe, 
-- cuando dichos salarios medios sean inferiores a 3000 euros
 

--18. Obtener los salarios medios por DEPARTAMENTOS de los vendedores y cuántos hay en cada departamento, 
--siempre que ese salario medio sea mayor de 1.200
 

--19. Obtener el número de departamento con mayor salario medio de sus EMPLEADOS, 
--visualizando también el valor del salario medio correspondiente.
 

--20. Obtener aquellos IDs de productos de los que se ha realizado más de un pedido 
--con la fecha de pedido anterior a 1 de enero del 2017.
 
  
 
